{"title":"MySQL练习","date":"2021-03-09T15:13:51.000Z","date_formatted":{"ll":"2021年3月9日","L":"2021/03/09","MM-DD":"03-09"},"link":"2021/03/09/MySQL练习","comments":true,"updated":"2022-11-16T02:30:28.833Z","content":"<h2 id=\"mysql练习\">MySQL练习<a title=\"#mysql练习\" href=\"#mysql练习\"></a></h2>\n<h3 id=\"数据库初始化\">数据库初始化<a title=\"#数据库初始化\" href=\"#数据库初始化\"></a></h3>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> if <span class=\"keyword\">exists</span> t_score;</span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> if <span class=\"keyword\">exists</span> t_courses;</span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> if <span class=\"keyword\">exists</span> t_students;</span><br><span class=\"line\"><span class=\"keyword\">drop</span> <span class=\"keyword\">table</span> if <span class=\"keyword\">exists</span> t_teachers;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 学生表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `Student`(</span><br><span class=\"line\">    `s_id` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    `s_name` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    `s_birth` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    `s_sex` <span class=\"type\">VARCHAR</span>(<span class=\"number\">10</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY(`s_id`)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- 课程表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `Course`(</span><br><span class=\"line\">    `c_id`  <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    `c_name` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    `t_id` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY(`c_id`)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- 教师表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `Teacher`(</span><br><span class=\"line\">    `t_id` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    `t_name` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>) <span class=\"keyword\">NOT</span> <span class=\"keyword\">NULL</span> <span class=\"keyword\">DEFAULT</span> <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY(`t_id`)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- 成绩表</span></span><br><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TABLE</span> `Score`(</span><br><span class=\"line\">    `s_id` <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    `c_id`  <span class=\"type\">VARCHAR</span>(<span class=\"number\">20</span>),</span><br><span class=\"line\">    `s_score` <span class=\"type\">INT</span>(<span class=\"number\">3</span>),</span><br><span class=\"line\">    <span class=\"keyword\">PRIMARY</span> KEY(`s_id`,`c_id`)</span><br><span class=\"line\">);</span><br><span class=\"line\"><span class=\"comment\">-- 插入学生表测试数据</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;01&#x27;</span> , <span class=\"string\">&#x27;赵雷&#x27;</span> , <span class=\"string\">&#x27;1990-01-01&#x27;</span> , <span class=\"string\">&#x27;男&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;02&#x27;</span> , <span class=\"string\">&#x27;钱电&#x27;</span> , <span class=\"string\">&#x27;1990-12-21&#x27;</span> , <span class=\"string\">&#x27;男&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;03&#x27;</span> , <span class=\"string\">&#x27;孙风&#x27;</span> , <span class=\"string\">&#x27;1990-05-20&#x27;</span> , <span class=\"string\">&#x27;男&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;04&#x27;</span> , <span class=\"string\">&#x27;李云&#x27;</span> , <span class=\"string\">&#x27;1990-08-06&#x27;</span> , <span class=\"string\">&#x27;男&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;05&#x27;</span> , <span class=\"string\">&#x27;周梅&#x27;</span> , <span class=\"string\">&#x27;1991-12-01&#x27;</span> , <span class=\"string\">&#x27;女&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;06&#x27;</span> , <span class=\"string\">&#x27;吴兰&#x27;</span> , <span class=\"string\">&#x27;1992-03-01&#x27;</span> , <span class=\"string\">&#x27;女&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;07&#x27;</span> , <span class=\"string\">&#x27;郑竹&#x27;</span> , <span class=\"string\">&#x27;1989-07-01&#x27;</span> , <span class=\"string\">&#x27;女&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Student <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;08&#x27;</span> , <span class=\"string\">&#x27;王菊&#x27;</span> , <span class=\"string\">&#x27;1990-01-20&#x27;</span> , <span class=\"string\">&#x27;女&#x27;</span>);</span><br><span class=\"line\"><span class=\"comment\">-- 课程表测试数据</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Course <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;01&#x27;</span> , <span class=\"string\">&#x27;语文&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Course <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;02&#x27;</span> , <span class=\"string\">&#x27;数学&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Course <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;03&#x27;</span> , <span class=\"string\">&#x27;英语&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 教师表测试数据</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Teacher <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;01&#x27;</span> , <span class=\"string\">&#x27;张三&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Teacher <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;02&#x27;</span> , <span class=\"string\">&#x27;李四&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Teacher <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;03&#x27;</span> , <span class=\"string\">&#x27;王五&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 成绩表测试数据</span></span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;01&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span> , <span class=\"number\">80</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;01&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span> , <span class=\"number\">90</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;01&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span> , <span class=\"number\">99</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;02&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span> , <span class=\"number\">70</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;02&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span> , <span class=\"number\">60</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;02&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span> , <span class=\"number\">80</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;03&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span> , <span class=\"number\">80</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;03&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span> , <span class=\"number\">80</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;03&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span> , <span class=\"number\">80</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;04&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span> , <span class=\"number\">50</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;04&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span> , <span class=\"number\">30</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;04&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span> , <span class=\"number\">20</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;05&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span> , <span class=\"number\">76</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;05&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span> , <span class=\"number\">87</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;06&#x27;</span> , <span class=\"string\">&#x27;01&#x27;</span> , <span class=\"number\">31</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;06&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span> , <span class=\"number\">34</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;07&#x27;</span> , <span class=\"string\">&#x27;02&#x27;</span> , <span class=\"number\">89</span>);</span><br><span class=\"line\"><span class=\"keyword\">insert</span> <span class=\"keyword\">into</span> Score <span class=\"keyword\">values</span>(<span class=\"string\">&#x27;07&#x27;</span> , <span class=\"string\">&#x27;03&#x27;</span> , <span class=\"number\">98</span>);</span><br></pre></td></tr></table></figure>\n<h3 id=\"练习题\">练习题<a title=\"#练习题\" href=\"#练习题\"></a></h3>\n<ol>\n<li>\n<p>查询&quot;01&quot;课程比&quot;02&quot;课程成绩高的学生的信息及课程分数</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name, stu.birthday, stu.stu_gender,</span><br><span class=\"line\">    ifnull(sc1.score, 0) as &#39;1课程分数&#39;, ifnull(sc2.score, 0) as &#39;2课程分数&#39;</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc1 on stu.stu_id &#x3D; sc1.stu_id and sc1.course_id &#x3D; 1</span><br><span class=\"line\">left join t_score sc2 on stu.stu_id &#x3D; sc2.stu_id and sc2.course_id &#x3D; 2</span><br><span class=\"line\">where ifnull(sc1.score, 0) &gt; ifnull(sc2.score, 0);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询&quot;01&quot;课程比&quot;02&quot;课程成绩低的学生的信息及课程分数</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name, stu.birthday, stu.stu_gender,</span><br><span class=\"line\">    ifnull(sc1.score, 0) as &#39;1课程分数&#39;, ifnull(sc2.score, 0) as &#39;2课程分数&#39;</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc1 on stu.stu_id &#x3D; sc1.stu_id and sc1.course_id &#x3D; 1</span><br><span class=\"line\">left join t_score sc2 on stu.stu_id &#x3D; sc2.stu_id and sc2.course_id &#x3D; 2</span><br><span class=\"line\">where ifnull(sc1.score, 0) &lt; ifnull(sc2.score, 0);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询平均成绩大于等于60分的同学的学生编号和学生姓名和平均成绩</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name, round(avg(sc.score), 2) as avg_score</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc on stu.stu_id &#x3D; sc.stu_id</span><br><span class=\"line\">group by stu.stu_id, stu.stu_name</span><br><span class=\"line\">having avg_score &gt;&#x3D; 60;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询平均成绩小于60分的同学的学生编号和学生姓名和平均成绩</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name, round(ifnull(avg(sc.score), 0), 2) as avg_score</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc on stu.stu_id &#x3D; sc.stu_id</span><br><span class=\"line\">group by stu.stu_id, stu.stu_name</span><br><span class=\"line\">having avg_score &lt; 60;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询所有同学的学生编号. 学生姓名. 选课总数. 所有课程的总成绩</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name, </span><br><span class=\"line\">    count(sc.course_id) as &#39;qty_course&#39;, -- 选课数量</span><br><span class=\"line\">    ifnull(sum(sc.score), 0) as &#39;sum_score&#39; -- 总分数</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc on stu.stu_id &#x3D; sc.stu_id</span><br><span class=\"line\">group by stu.stu_id, stu.stu_name;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询&quot;李&quot;姓老师的数量</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select count(0) from t_teachers</span><br><span class=\"line\">where teacher_name like &#39;李%&#39;;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询学过&quot;张三&quot;老师授课的同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.* from t_students stu</span><br><span class=\"line\">where stu.stu_id in (</span><br><span class=\"line\">    select sc.stu_id from t_score sc</span><br><span class=\"line\">    left join t_courses cou on sc.course_id &#x3D; cou.course_id</span><br><span class=\"line\">    left join t_teachers te on cou.teacher_id &#x3D; te.teacher_id</span><br><span class=\"line\">    where te.teacher_name &#x3D; &#39;贝吉塔&#39;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询没学过&quot;张三&quot;老师授课的同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.* from t_students stu</span><br><span class=\"line\">where stu.stu_id not in (</span><br><span class=\"line\">    select sc.stu_id from t_score sc</span><br><span class=\"line\">    left join t_courses cou on sc.course_id &#x3D; cou.course_id</span><br><span class=\"line\">    left join t_teachers te on cou.teacher_id &#x3D; te.teacher_id</span><br><span class=\"line\">    where te.teacher_name &#x3D; &#39;贝吉塔&#39;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询学过编号为&quot;01&quot;并且也学过编号为&quot;02&quot;的课程的同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu_id, stu_name, birthday, stu_gender</span><br><span class=\"line\">from t_students</span><br><span class=\"line\">where stu_id in (</span><br><span class=\"line\">    select stu_id</span><br><span class=\"line\">    from t_score</span><br><span class=\"line\">    where course_id &#x3D; 1)</span><br><span class=\"line\">and stu_id in (</span><br><span class=\"line\">    select stu_id</span><br><span class=\"line\">    from t_score</span><br><span class=\"line\">    where course_id &#x3D; 2);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询学过编号为&quot;01&quot;但是没有学过编号为&quot;02&quot;的课程的同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu_id, stu_name, birthday, stu_gender</span><br><span class=\"line\">from t_students</span><br><span class=\"line\">where stu_id in (</span><br><span class=\"line\">    select stu_id</span><br><span class=\"line\">    from t_score</span><br><span class=\"line\">    where course_id &#x3D; 1)</span><br><span class=\"line\">and stu_id not in (</span><br><span class=\"line\">    select stu_id</span><br><span class=\"line\">    from t_score</span><br><span class=\"line\">    where course_id &#x3D; 2);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询没有学全所有课程的同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select student_id, student_name</span><br><span class=\"line\">from tb_student</span><br><span class=\"line\">where student_id in (</span><br><span class=\"line\">    select stu.student_id</span><br><span class=\"line\">    from tb_student stu</span><br><span class=\"line\">    left join tb_score sc on stu.student_id &#x3D; sc.student_id</span><br><span class=\"line\">    group by student_id</span><br><span class=\"line\">    having count(course_id) &lt; (</span><br><span class=\"line\">        select count(0)</span><br><span class=\"line\">        from tb_course</span><br><span class=\"line\">    )</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询至少有一门课与学号为&quot;01&quot;的同学所学相同的同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from t_students</span><br><span class=\"line\">where stu_id in (</span><br><span class=\"line\">\tselect stu_id from t_score</span><br><span class=\"line\">\twhere course_id in (</span><br><span class=\"line\">\t\tselect course_id from t_score where stu_id &#x3D; 1</span><br><span class=\"line\">\t) and stu_id !&#x3D; 1</span><br><span class=\"line\">\tgroup by stu_id</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询和&quot;01&quot;号的同学学习的课程完全相同的其他同学的信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from t_students where stu_id in (</span><br><span class=\"line\">\tselect temp.stu_id from (</span><br><span class=\"line\">\t\tselect sc.stu_id, group_concat(crs.course_name) as courses</span><br><span class=\"line\">\t\tfrom t_score sc</span><br><span class=\"line\">\t\tleft join t_courses crs on sc.course_id &#x3D; crs.course_id</span><br><span class=\"line\">\t\tgroup by sc.stu_id</span><br><span class=\"line\">\t) temp where temp.courses &#x3D; (</span><br><span class=\"line\">\t\tselect group_concat(crs.course_name) as courses</span><br><span class=\"line\">\t\tfrom t_score sc</span><br><span class=\"line\">\t\tleft join t_courses crs on sc.course_id &#x3D; crs.course_id</span><br><span class=\"line\">\t\tgroup by sc.stu_id</span><br><span class=\"line\">\t\thaving sc.stu_id &#x3D; 1</span><br><span class=\"line\">\t) and temp.stu_id !&#x3D; 1</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询没学过&quot;张三&quot;老师讲授的任一门课程的学生姓名</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_name from t_students stu where stu.stu_id not in (</span><br><span class=\"line\">    select sc.stu_id from t_score sc -- 学过贝吉塔教的课的学生id</span><br><span class=\"line\">    left join t_courses cou on sc.course_id &#x3D; cou.course_id</span><br><span class=\"line\">    left join t_teachers tc on cou.teacher_id &#x3D; tc.teacher_id</span><br><span class=\"line\">    where tc.teacher_name &#x3D; &#39;贝吉塔&#39;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询两门及其以上不及格课程的同学的学号，姓名及其平均成绩</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name, avg(sc.score)</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join  t_score sc on stu.stu_id &#x3D; sc.stu_id</span><br><span class=\"line\">group by stu.stu_id, stu.stu_name</span><br><span class=\"line\">having sum(</span><br><span class=\"line\">\tcase </span><br><span class=\"line\">\twhen ifnull(sc.score, 0) &lt; 60 then 1</span><br><span class=\"line\">\telse 0 end</span><br><span class=\"line\">) &gt;&#x3D; 2;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>检索&quot;01&quot;课程分数小于60，按分数降序排列的学生信息</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.*, sum(sc.score) as score_sum</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc on stu.stu_id &#x3D; sc.stu_id</span><br><span class=\"line\">where stu.stu_id in (</span><br><span class=\"line\">\tselect stu_id from t_score</span><br><span class=\"line\">\twhere course_id &#x3D; 1 and score &lt; 60</span><br><span class=\"line\">) group by stu.stu_id</span><br><span class=\"line\">order by score_sum desc;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>按平均成绩从高到低显示所有学生的所有课程的成绩以及平均成绩</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select stu.stu_id, stu.stu_name,</span><br><span class=\"line\">  ifnull(sc1.score, 0) as yw_score, -- 语文分数</span><br><span class=\"line\">  ifnull(sc2.score, 0) as sx_score, -- 数学分数</span><br><span class=\"line\">  ifnull(sc3.score, 0) as yy_score, -- 英语分数</span><br><span class=\"line\">  round(ifnull(avg_t.avg_score, 0), 2) as avg_score</span><br><span class=\"line\">from t_students stu</span><br><span class=\"line\">left join t_score sc1 on stu.stu_id &#x3D; sc1.stu_id and sc1.course_id &#x3D; 1 -- 语文成绩表</span><br><span class=\"line\">left join t_score sc2 on stu.stu_id &#x3D; sc2.stu_id and sc2.course_id &#x3D; 2 -- 数学成绩表</span><br><span class=\"line\">left join t_score sc3 on stu.stu_id &#x3D; sc3.stu_id and sc3.course_id &#x3D; 3 -- 英语成绩表</span><br><span class=\"line\">left join ( -- 子查询, 临时表</span><br><span class=\"line\">    select stu_id, avg(score) as avg_score -- 平均分</span><br><span class=\"line\">    from t_score</span><br><span class=\"line\">    group by stu_id</span><br><span class=\"line\">    order by avg_score</span><br><span class=\"line\">    ) avg_t on stu.stu_id &#x3D; avg_t.stu_id</span><br><span class=\"line\">order by avg_t.avg_score desc;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>查询各科成绩最高分. 最低分和平均分：以如下形式显示：课程ID，课程name，最高分，最低分，平均分，及格率，中等率，优良率，优秀率 及格为&gt;=60，中等为：70-80，优良为：80-90，优秀为：&gt;=90</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select sc.course_id, crs.course_name,</span><br><span class=\"line\">    max(sc.score) as max_score,</span><br><span class=\"line\">    min(sc.score) as min_score,</span><br><span class=\"line\">    avg(sc.score) as avg_score,</span><br><span class=\"line\">    sum(sc.score &gt;&#x3D; 60) &#x2F; 8 as pass_per,</span><br><span class=\"line\">    sum(sc.score &gt;&#x3D; 70 and sc.score &lt; 80) &#x2F; 8 as medium_per,</span><br><span class=\"line\">    sum(</span><br><span class=\"line\">    \tcase</span><br><span class=\"line\">    \twhen sc.score &gt;&#x3D; 80 and sc.score &lt; 90 then 1</span><br><span class=\"line\">    \telse 0</span><br><span class=\"line\">    \tend</span><br><span class=\"line\">    ) &#x2F; 8 as good_per,</span><br><span class=\"line\">    sum(</span><br><span class=\"line\">    \tcase</span><br><span class=\"line\">    \twhen sc.score &gt;&#x3D; 90 then 1</span><br><span class=\"line\">    \telse 0</span><br><span class=\"line\">    \tend</span><br><span class=\"line\">    ) &#x2F; 8 as perfect_per</span><br><span class=\"line\">from t_score sc</span><br><span class=\"line\">right join t_courses crs on sc.course_id &#x3D; crs.course_id</span><br><span class=\"line\">group by sc.course_id, crs.course_name;</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>按各科成绩进行排序，并显示排名</p>\n</li>\n<li>\n<p>查询学生的总成绩并进行排名</p>\n<ol>\n<li>查询学生的总成绩</li>\n<li>查询学生的总成绩并进行排名，sql 2000用子查询完成，分总分重复时保留名次空缺和不保留名次空缺两种。</li>\n<li>查询学生的总成绩并进行排名，sql 2005用rank,DENSE_RANK完成，分总分重复时保留名次空缺和不保留名次空缺两种。</li>\n</ol>\n</li>\n<li>\n<p>查询不同老师所教不同课程平均分从高到低显示</p>\n</li>\n<li>\n<p>查询所有课程的成绩第2名到第3名的学生信息及该课程成绩</p>\n</li>\n<li>\n<p>统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]及所占百分比</p>\n<ol>\n<li>统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[0-60]</li>\n<li>统计各科成绩各分数段人数：课程编号,课程名称,[100-85],[85-70],[70-60],[&lt;60]及所占百分比</li>\n</ol>\n</li>\n<li>\n<p>查询学生平均成绩及其名次</p>\n<ol>\n<li>查询学生的平均成绩并进行排名，sql 2000用子查询完成，分平均成绩重复时保留名次空缺和不保留名次空缺两种。</li>\n<li>查询学生的平均成绩并进行排名，sql 2005用rank,DENSE_RANK完成，分平均成绩重复时保留名次空缺和不保留名次空缺两种。</li>\n</ol>\n</li>\n<li>\n<p>查询各科成绩前三名的记录</p>\n<ol>\n<li>分数重复时保留名次空缺</li>\n<li>分数重复时不保留名次空缺，合并名次</li>\n</ol>\n</li>\n<li>\n<p>查询每门课程被选修的学生数</p>\n</li>\n<li>\n<p>查询出只有两门课程的全部学生的学号和姓名</p>\n</li>\n<li>\n<p>查询男生. 女生人数</p>\n</li>\n<li>\n<p>查询名字中含有&quot;风&quot;字的学生信息</p>\n</li>\n<li>\n<p>查询同名同性学生名单，并统计同名人数</p>\n</li>\n<li>\n<p>查询1990年出生的学生名单</p>\n</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT *</span><br><span class=\"line\">FROM t_students</span><br><span class=\"line\">WHERE EXTRACT(YEAR FROM birthday) &#x3D; 1990;</span><br></pre></td></tr></table></figure>\n<ol start=\"32\">\n<li>查询每门课程的平均成绩，结果按平均成绩降序排列，平均成绩相同时，按课程编号升序排列</li>\n<li>查询平均成绩大于等于85的所有学生的学号. 姓名和平均成绩</li>\n<li>查询课程名称为&quot;数学&quot;，且分数低于60的学生姓名和分数</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT</span><br><span class=\"line\">  t_students.stu_name,</span><br><span class=\"line\">  t_score.score</span><br><span class=\"line\">FROM t_score</span><br><span class=\"line\">  CROSS JOIN t_courses ON t_score.course_id &#x3D; t_courses.course_id AND t_courses.course_name &#x3D; &#39;数学&#39;</span><br><span class=\"line\">  CROSS JOIN t_students ON t_score.stu_id &#x3D; t_students.stu_id</span><br><span class=\"line\">WHERE score &lt; 60</span><br></pre></td></tr></table></figure>\n<ol start=\"35\">\n<li>查询所有学生的课程及分数情况；</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT stu_name,score,course_name FROM t_students</span><br><span class=\"line\">LEFT JOIN t_score ON t_students.stu_id &#x3D; t_score.stu_id</span><br><span class=\"line\">LEFT JOIN t_courses ON t_score.course_id &#x3D; t_courses.course_id;</span><br></pre></td></tr></table></figure>\n<ol start=\"36\">\n<li>查询任何一门课程成绩在70分以上的姓名. 课程名称和分数；</li>\n<li>查询不及格的课程</li>\n<li>查询课程编号为01且课程成绩在80分以上的学生的学号和姓名；</li>\n<li>求每门课程的学生人数</li>\n<li>查询选修&quot;张三&quot;老师所授课程的学生中，成绩最高的学生信息及其成绩\n<ol>\n<li>当最高分只有一个时</li>\n<li>当最高分出现多个时</li>\n</ol>\n</li>\n<li>查询不同课程成绩相同的学生的学生编号. 课程编号. 学生成绩</li>\n<li>查询每门功成绩最好的前两名</li>\n<li>统计每门课程的学生选修人数（超过5人的课程才统计）。要求输出课程号和选修人数，查询结果按人数降序排列，若人数相同，按课程号升序排列</li>\n<li>检索至少选修两门课程的学生学号</li>\n<li>查询选修了全部课程的学生信息</li>\n<li>查询各学生的年龄\n<ol>\n<li>只按照年份来算</li>\n<li>按照出生日期来算，当前月日 &lt; 出生年月的月日则，年龄减一</li>\n</ol>\n</li>\n<li>查询本周过生日的学生</li>\n<li>查询下周过生日的学生</li>\n<li>查询本月过生日的学生</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT *</span><br><span class=\"line\">FROM t_students</span><br><span class=\"line\">WHERE EXTRACT(MONTH FROM birthday) &#x3D; EXTRACT(MONTH FROM curdate());</span><br></pre></td></tr></table></figure>\n<ol start=\"50\">\n<li>查询下月过生日的学生</li>\n</ol>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SELECT *</span><br><span class=\"line\">FROM t_students</span><br><span class=\"line\">WHERE EXTRACT(MONTH FROM birthday) &#x3D; EXTRACT(MONTH FROM curdate()) + 1</span><br><span class=\"line\">      OR EXTRACT(MONTH FROM birthday) &#x3D; 1 AND EXTRACT(MONTH FROM curdate()) &#x3D; 12;</span><br></pre></td></tr></table></figure>","prev":{"title":"脚本","link":"2021/03/18/脚本"},"next":{"title":"MySQL中的索引","link":"2021/03/09/MySQL中的索引"},"plink":"https://blog.liumulin.top/2021/03/09/MySQL练习/","toc":[{"id":"mysql练习","title":"MySQL练习","index":"1","children":[{"id":"数据库初始化","title":"数据库初始化","index":"1.1"},{"id":"练习题","title":"练习题","index":"1.2"}]}],"reward":true,"copyright":{"custom":"不许转载😡！！！"}}